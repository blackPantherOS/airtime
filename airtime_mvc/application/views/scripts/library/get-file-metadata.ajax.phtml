<?php if($this->type == "audioclip") : ?>
<table class='library-track-md'>
<tr><td>Title:</td><td><?php echo ($this->md["MDATA_KEY_TITLE"]);?></td></tr>
<tr><td>Creator:</td><td><?php echo ($this->md["MDATA_KEY_CREATOR"]);?></td></tr>
<tr><td>Album:</td><td><?php echo ($this->md["MDATA_KEY_SOURCE"]);?></td></tr>
<tr><td>Track:</td><td><?php echo ($this->md["MDATA_KEY_TRACKNUMBER"]);?></td></tr>
<tr><td>Length:</td><td><?php echo ($this->md["MDATA_KEY_DURATION"]);?></td></tr>
<tr><td>Sample Rate:</td><td><?php echo ($this->md["MDATA_KEY_SAMPLERATE"]);?></td></tr>
<tr><td>Bit Rate:</td><td><?php echo ($this->md["MDATA_KEY_BITRATE"]);?></td></tr>
<tr><td>Mood:</td><td><?php echo ($this->md["MDATA_KEY_MOOD"]);?></td></tr>
<tr><td>Genre:</td><td><?php echo ($this->md["MDATA_KEY_GENRE"]);?></td></tr>
<tr><td>Year:</td><td><?php echo ($this->md["MDATA_KEY_YEAR"]);?></td></tr>
<tr><td>Label:</td><td><?php echo ($this->md["MDATA_KEY_LABEL"]);?></td></tr>
<tr><td>BPM:</td><td><?php echo ($this->md["MDATA_KEY_BPM"]);?></td></tr>
<tr><td>Composer:</td><td><?php echo ($this->md["MDATA_KEY_COMPOSER"]);?></td></tr>
<tr><td>Conductor:</td><td><?php echo ($this->md["MDATA_KEY_CONDUCTOR"]);?></td></tr>
<tr><td>Copyright:</td><td><?php echo ($this->md["MDATA_KEY_COPYRIGHT"]);?></td></tr>
<tr><td>Isrc Number:</td><td><?php echo ($this->md["MDATA_KEY_ISRC"]);?></td></tr>
<tr><td>Website:</td><td><?php echo ($this->md["MDATA_KEY_URL"]);?></td></tr>
<tr><td>Language:</td><td><?php echo ($this->md["MDATA_KEY_LANGUAGE"]);?></td></tr>
<tr><td>File&nbsp;Path:</td><td><?php echo ($this->md["MDATA_KEY_FILEPATH"]);?></td></tr>
</table>
<?php endif; ?>

<?php if($this->type == "playlist" || $this->type == "block") : ?>
<div class='file-md-qtip-left'>
    <span>Name:</span><span><?php echo ($this->md["dc:title"]);?></span><br />
    <span>Creator:</span><span><?php echo ($this->md["dc:creator"]);?></span><br />
    <?php if ($this->type == "block" && $this->blType == "Dynamic") { ?>
    <span>Length:</span><span><?php echo $this->block->getLength();?></span><br />
    <?php } else { ?>
    <span>Length:</span><span><?php echo ($this->md["dcterms:extent"]);?></span><br />
    <?php } ?>
    <span>Description:</span><span><?php echo ($this->md["dc:description"]);?></span>
</div>

<?php if ($this->type == "playlist") { ?>
<div class='file-md-qtip-legend'>
<span class='webstream'>o</span> <span>Web Stream</span><br />
<span class='dynamic'>o</span> <span>Dynamic Playlist</span><br />
<span class='static'>o</span> <span>Static Playlist</span><br />
<span>o</span> <span>Audio Track</span>
</div>
<?php } ?>

    <?php if ($this->type == "playlist" || ($this->type == "block" && $this->blType == "Static")) {?>
        <?php if ($this->type == "playlist") { ?>
            <div class='file-md-qtip-left'><span>Playlist Contents: </span></div>
        <?php } else { ?>
            <div class='file-md-qtip-left'><span>Static Playlist Contents: </span></div>
        <?php } ?>
        <table class='library-get-file-md'>
        <?php foreach($this->contents as $row) : ?>
            <?php
            $titleMaxStrLen = 35;
            if (mb_strlen($row["track_title"], 'UTF-8') > $titleMaxStrLen) {
                $row["track_title"] = mb_substr($row["track_title"], 0, 34, 'UTF-8')."...";
            }
            $artistMaxStrLen = 22;
            if (mb_strlen($row["creator"], 'UTF-8') > $artistMaxStrLen) {
                $row["creator"] = mb_substr($row["creator"], 0, 21, 'UTF-8')."...";
            }
            ?>
            <?php if ($row["type"] == 2) {
                $bl = new Application_Model_Block($row["item_id"]);
                $isStatic = $bl->isStatic(); ?>
                <tr class='file-md-qtip-playlist <?php if ($isStatic) echo 'static'; else echo 'dynamic';?>'>
                    <td class='file-md-qtip-row-width-title file-md-qtip-nowrap'><?php echo $row["track_title"] ?></td>
                    <td class='file-md-qtip-row-width-artist file-md-qtip-nowrap'><?php echo $row["creator"] ?></td>
                    <td class='file-md-qtip-row-width-small'><?php echo $bl->getLength(); ?></td>
                </tr>
            <?php } else if ($row["type"] == 1) {?>
                <tr class='file-md-qtip-playlist webstream'>
                    <td class='file-md-qtip-row-width-title file-md-qtip-nowrap'><?php echo $row["track_title"] ?></td>
                    <td class='file-md-qtip-row-width-artist file-md-qtip-nowrap'><?php echo $row["creator"] ?></td>
                    <td class='file-md-qtip-row-width-small'><?php echo $row["length"] ?></td>
                </tr>
            <?php } else { ?>
                <tr>
                    <td class='file-md-qtip-row-width-title file-md-qtip-nowrap'><?php echo $row["track_title"] ?></td>
                    <td class='file-md-qtip-row-width-artist file-md-qtip-nowrap'><?php echo $row["creator"] ?></td>
                    <td class='file-md-qtip-row-width-small'><?php echo $row["length"] ?></td>
                </tr>
            <?php } ?>
        <?php endforeach; ?>
        </table>
        
    <?php } elseif ($this->blType == "Dynamic") { ?>
        <div class='file-md-qtip-left'><span>Dynamic Playlist Criteria: </span></div>
        <table class='library-get-file-md table-small'>
        <?php foreach ($this->contents["crit"] as $criterias) : ?>
            <?php foreach ($criterias as $crit ) : ?>
                <?php
                $valMaxStrLen = 25;
                if (strlen($crit["value"]) > $valMaxStrLen) {
                    $crit["value"] = substr($crit["value"], 0, 24)."...";
                }
                $critMaxStrLen = 13;
                if (strlen($crit["display_name"]) > $critMaxStrLen) {
                    $crit["display_name"] = substr($crit["display_name"], 0, 12)."...";
                }
                $modMaxStrLen = 16;
                if (strlen($crit["modifier"]) > $modMaxStrLen) {
                    $crit["modifier"] = substr($crit["modifier"], 0, 15)."...";
                }
                ?>
                <tr>
                    <td class='file-md-qtip-criteria-width-small file-md-qtip-nowrap'><?php echo $crit["display_name"] ?></td>
                    <td class='file-md-qtip-criteria-width-small file-md-qtip-nowrap'><?php echo $crit["modifier"] ?></td>
                    <td class='file-md-qtip-criteria-width file-md-qtip-nowrap'><?php echo $crit["value"] ?>
                    <?php if (isset($crit["extra"])) { ?>
                        to <?php echo $crit["extra"] ?></td>
                    <?php } ?>
                </tr>
            <?php endforeach; ?>
        <?php endforeach; ?>
            <tr>
                <td>Limit to </td>
                <td><?php echo $this->contents["limit"]["value"] ?> <?php echo $this->contents["limit"]["modifier"] ?></td>
            </tr>
        </table>
    <?php } ?>
<?php endif; ?>

<?php if ($this->type == "stream") : ?>

<div><span>Name:</span><span><?php echo ($this->md["name"]);?></span></div>
<div><span>Length:</span><span><?php echo ($this->md["length"]);?></span></div>
<div><span>Creator:</span><span><?php echo ($this->md["login"]);?></span></div>
<div><span>Description:</span><span><?php echo ($this->md["description"]);?></span></div>
<div><span>URL:</span><span><?php echo ($this->md["url"]);?></span></div>


<?php endif; ?>
